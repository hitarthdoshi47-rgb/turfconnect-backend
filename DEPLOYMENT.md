# TurfConnect Deployment Guide

## üöÄ Quick Start Deployment

### Option 1: Railway (Recommended for MVP)

#### Step 1: Deploy Backend

1. **Create Railway Account**
   - Go to [railway.app](https://railway.app)
   - Sign up with GitHub

2. **Create New Project**
   - Click "New Project"
   - Select "Deploy from GitHub repo"
   - Choose `turfconnect-backend`

3. **Add PostgreSQL Database**
   - In your project, click "New"
   - Select "Database" ‚Üí "PostgreSQL"
   - Railway will automatically create `DATABASE_URL`

4. **Set Environment Variables**
   ```
   DATABASE_URL=(auto-generated by Railway)
   JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
   JWT_REFRESH_SECRET=your-refresh-secret-key-change-this
   JWT_EXPIRES_IN=15m
   JWT_REFRESH_EXPIRES_IN=7d
   NODE_ENV=production
   PORT=5000
   ```

5. **Deploy**
   - Railway will automatically deploy
   - Get your deployment URL (e.g., `https://turfconnect-backend.up.railway.app`)

6. **Run Database Migrations**
   - In Railway dashboard, go to your service
   - Click "Settings" ‚Üí "Deploy"
   - Add build command: `npx prisma migrate deploy && npx prisma generate`

#### Step 2: Deploy Frontend (Vercel)

1. **Create Vercel Account**
   - Go to [vercel.com](https://vercel.com)
   - Sign up with GitHub

2. **Import Project**
   - Click "Add New" ‚Üí "Project"
   - Import `turfconnect-web`

3. **Configure**
   - Framework Preset: Next.js
   - Build Command: `npm run build`
   - Output Directory: `.next`

4. **Set Environment Variables**
   ```
   NEXT_PUBLIC_API_URL=https://your-railway-backend-url.railway.app/api/v1
   ```

5. **Deploy**
   - Click "Deploy"
   - Your app will be live at `https://turfconnect-web.vercel.app`

---

## üîß Manual Deployment (VPS/EC2)

### Prerequisites
- Ubuntu 22.04 LTS server
- Node.js 18+
- PostgreSQL 15+
- Nginx
- PM2

### Step 1: Server Setup

```bash
# Update system
sudo apt update && sudo apt upgrade -y

# Install Node.js 18
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt install -y nodejs

# Install PostgreSQL
sudo apt install -y postgresql postgresql-contrib

# Install Nginx
sudo apt install -y nginx

# Install PM2
sudo npm install -g pm2
```

### Step 2: Database Setup

```bash
# Switch to postgres user
sudo -u postgres psql

# Create database and user
CREATE DATABASE turfconnect;
CREATE USER turfconnect_user WITH PASSWORD 'your_secure_password';
GRANT ALL PRIVILEGES ON DATABASE turfconnect TO turfconnect_user;
\q
```

### Step 3: Deploy Backend

```bash
# Clone repository
git clone https://github.com/hitarthdoshi47-rgb/turfconnect-backend.git
cd turfconnect-backend

# Install dependencies
npm install

# Create .env file
cp .env.example .env
nano .env  # Edit with your values

# Run migrations
npx prisma migrate deploy
npx prisma generate

# Build
npm run build

# Start with PM2
pm2 start dist/server.js --name turfconnect-api
pm2 save
pm2 startup
```

### Step 4: Configure Nginx

```bash
sudo nano /etc/nginx/sites-available/turfconnect
```

Add:
```nginx
server {
    listen 80;
    server_name api.turfconnect.in;

    location / {
        proxy_pass http://localhost:5000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}
```

```bash
# Enable site
sudo ln -s /etc/nginx/sites-available/turfconnect /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl restart nginx
```

### Step 5: SSL Certificate (Let's Encrypt)

```bash
sudo apt install -y certbot python3-certbot-nginx
sudo certbot --nginx -d api.turfconnect.in
```

---

## üê≥ Docker Deployment

### Build and Run

```bash
# Build image
docker build -t turfconnect-backend .

# Run with docker-compose
docker-compose up -d
```

### docker-compose.yml

```yaml
version: '3.8'

services:
  postgres:
    image: postgres:15-alpine
    environment:
      POSTGRES_DB: turfconnect
      POSTGRES_USER: turfconnect_user
      POSTGRES_PASSWORD: your_password
    volumes:
      - postgres_data:/var/lib/postgresql/data
    ports:
      - "5432:5432"

  backend:
    build: .
    ports:
      - "5000:5000"
    environment:
      DATABASE_URL: postgresql://turfconnect_user:your_password@postgres:5432/turfconnect
      JWT_SECRET: your_jwt_secret
      NODE_ENV: production
    depends_on:
      - postgres

volumes:
  postgres_data:
```

---

## üì± Mobile App Deployment

### React Native Setup

```bash
# Install React Native CLI
npm install -g react-native-cli

# Create new project
npx react-native init TurfConnectApp --template react-native-template-typescript

# Install dependencies
cd TurfConnectApp
npm install @react-navigation/native @react-navigation/stack
npm install react-native-screens react-native-safe-area-context
npm install axios zustand
```

### iOS Deployment

```bash
cd ios
pod install
cd ..

# Run on simulator
npx react-native run-ios

# Build for TestFlight
# Open Xcode ‚Üí Product ‚Üí Archive
```

### Android Deployment

```bash
# Run on emulator
npx react-native run-android

# Build APK
cd android
./gradlew assembleRelease

# APK location: android/app/build/outputs/apk/release/app-release.apk
```

---

## üîê Security Checklist

- [ ] Change all default passwords
- [ ] Set strong JWT secrets
- [ ] Enable HTTPS/SSL
- [ ] Configure CORS properly
- [ ] Set up rate limiting
- [ ] Enable database backups
- [ ] Set up monitoring (Sentry)
- [ ] Configure firewall rules
- [ ] Use environment variables (never commit secrets)
- [ ] Enable 2FA for deployment accounts

---

## üìä Monitoring & Logging

### Sentry Setup

```bash
npm install @sentry/node

# Add to server.ts
import * as Sentry from '@sentry/node';

Sentry.init({
  dsn: process.env.SENTRY_DSN,
  environment: process.env.NODE_ENV,
});
```

### PM2 Monitoring

```bash
pm2 install pm2-logrotate
pm2 set pm2-logrotate:max_size 10M
pm2 set pm2-logrotate:retain 7
```

---

## üîÑ CI/CD with GitHub Actions

Create `.github/workflows/deploy.yml`:

```yaml
name: Deploy to Railway

on:
  push:
    branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Deploy to Railway
        run: |
          npm install -g @railway/cli
          railway up
        env:
          RAILWAY_TOKEN: ${{ secrets.RAILWAY_TOKEN }}
```

---

## üìû Support

For deployment issues:
- Email: support@turfconnect.in
- GitHub Issues: [Create Issue](https://github.com/hitarthdoshi47-rgb/turfconnect-backend/issues)

---

**TurfConnect** - Built with ‚ù§Ô∏è for Indian sports enthusiasts!